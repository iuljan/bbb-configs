---
location: k9-nonpub
location_nice: Kinzigstra√üe 9, 10247 Berlin
latitude: 52.51378093260403
longitude: 13.466068518122656
altitude: 60
contact_nickname: 'K9 Freifunk Team'
contacts:
  - 'freifunk@kinzig9.de'

hosts:
  # - hostname: k9-core
  #   role: corerouter
  #   model: "avm_fritzbox-7530"
  #   wireless_profile: freifunk_default
  # - hostname: k9-ap-loge
  #   role: ap
  #   model: "aruba_ap-303"
  #   wireless_profile: freifunk_default
  # - hostname: k9-ap-groessenwahn
  #   role: ap
  #   model: "aruba_ap-303"
  #   wireless_profile: freifunk_default
  # - hostname: k9-ap-iuljan
  #   role: ap
  #   model: "dlink_dap-x1860-a1"
  #   wireless_profile: freifunk_default
  # - hostname: k9-switch-front-house
  #   role: ap
  #   model: "ubnt_usw-flex"
  #   poemgr_ports:
  #     - name: lan2
  #       port: 3
  #       disabled: 1
  #     - name: lan3  # PoE @ Loge
  #       port: 2
  #       disabled: 0
  #     - name: lan4
  #       port: 1
  #       disabled: 1
  #     - name: lan5
  #       port: 0
  #       disabled: 1
  #   # custom switch config script. Should be applied with a mechanism, that
  #   # includes files into root files system later on.
  #   host__rclocal__to_merge:
  #     - |
  #       # Remove vlan 10 & 11 (antennas)
  #       uci delete network.vlan_10
  #       uci delete network.vlan_11
  #       uci commit network
  #       reload_config
  #       # tag mgmt traffic on ap ports only
  #       uci set network.vlan_439.ports='lan1:t lan2 lan3:t lan4 lan5:t'
  #       # tag DHCP on all ports
  #       uci set network.vlan_40.ports='lan1:t lan2:t lan3:t lan4:t lan5:t'
  #       uci commit network; reload_config
  - hostname: k9ap-12  # Anna-lea
    role: ap
    model: "tplink_archer-c7-v5"
    wireless_profile: k9+freifunk
  - hostname: k9ap-14 # Buero
    role: ap
    model: "dlink_dap-x1860-a1"
    wireless_profile: k9+freifunk
  - hostname: k9ap-18 # Heinz
    role: ap
    model: "cudy_wr3000s-v1"
    wireless_profile: k9+freifunk
  - hostname: k9ap-31 # SF Kueche
    role: ap
    model: "tplink_archer-c7-v5"
    wireless_profile: k9+freifunk
  - hostname: k9ap-35 # Katrin
    role: ap
    model: "tplink_archer-c7-v5"
    wireless_profile: k9+freifunk
  - hostname: k9ap-36 # Ronja
    role: ap
    model: "dlink_dap-x1860-a1"
    wireless_profile: k9+freifunk
  - hostname: k9ap-37 # Kerrin
    role: ap
    model: "dlink_dap-x1860-a1"
    wireless_profile: k9+freifunk
  - hostname: k9ap-39 # 5.OG Kueche
    role: ap
    model: "dlink_dap-x1860-a1"
    wireless_profile: k9+freifunk
  - hostname: k9ap-40 # Hannah
    role: ap
    model: "dlink_covr-x1860-a1"
    wireless_profile: k9+freifunk
  - hostname: k9ap-41 # Percy
    role: ap
    model: "dlink_covr-x1860-a1"
    wireless_profile: k9+freifunk

snmp_devices:
  - hostname: k9-sama
    address: 10.31.9.243
    snmp_profile: af60

  - hostname: k9-zwingli
    address: 10.31.9.244
    snmp_profile: airos_8

ipv6_prefix: '2001:bf7:830:8d00::/56'

# K9 Prefixes:
# 10.31.9.0/24

# - 10.31.9.0/25 - DHCP
# - 10.31.9.224/28 - BBB-Mesh
# - 10.31.9.240/28 - MGMT

networks:
  # # MESH - Sama
  # - vid: 10
  #   role: mesh
  #   name: mesh_sama
  #   prefix: 10.31.9.224/32
  #   ipv6_subprefix: -1
  #   mesh_metric: 128

  # # MESH - Zwingli
  # - vid: 11
  #   role: mesh
  #   name: mesh_zwingli
  #   prefix: 10.31.9.225/32
  #   ipv6_subprefix: -2
  #   mesh_metric: 1024
  #   mesh_metric_lqm: ['default 0.5']

  # DHCP
  - vid: 40
    role: dhcp
    inbound_filtering: true
    enforce_client_isolation: true
    prefix: 10.31.9.0/25
    ipv6_subprefix: 0
    assignments:
      k9-core: 1

  # # MGMT
  # - vid: 439
  #   role: mgmt
  #   prefix: 10.31.9.240/28
  #   gateway: 1
  #   dns: 1
  #   ipv6_subprefix: 1
  #   assignments:
  #     k9-core: 1
  #     k9-switch-roof: 2         # uisp-s
  #     k9-sama: 3                # wave nano
  #     k9-zwingli: 4
  #     k9-switch-front-house: 7  # ubiquiti usw-flex-poe
  #     k9-switch-back-house: 8   # hpe 2520g-poe
  #     k9-ap-loge: 9
  #     k9-ap-groessenwahn: 10
  #     k9-ap-iuljan: 11
  #     k9ap-41: 12

  - vid: 1
    name: k9_dhcp
    role: ext
    prefix: 172.17.9.0/24
    gateway: 1
    broadcast: 172.17.9.255
    dns:
      - '172.16.9.5'
      - '172.16.9.126'
    no_corerouter_dns_record: true
    enforce_client_isolation: false
    # inbound_filtering: true
    untagged: true
    assignments:
      k9ap-12: 12
      k9ap-14: 14
      k9ap-18: 18
      k9ap-31: 31
      k9ap-35: 35
      k9ap-36: 36
      k9ap-37: 37
      k9ap-39: 39
      k9ap-40: 40
      k9ap-41: 41

location__wireless_profiles__to_merge:
  - name: k9+freifunk
    ifaces:
      - mode: ap
        ssid: berlin.freifunk.net
        encryption: none
        network: dhcp
        radio: [11a_standard, 11g_standard]
        ifname_hint: ff
        owe_transition_ifname_hint: ffowe

      - mode: ap
        ssid: berlin.freifunk.net Encrypted
        encryption: owe
        network: dhcp
        radio: [11a_standard, 11g_standard]
        ifname_hint: ffowe
        owe_transition_ifname_hint: ff
        ieee80211w: 1 # 1 optional, 2 required

      - mode: ap
        ssid: k9wlan-neu
        encryption: sae-mixed
        key: 'file:/root/wifi_pass' # erst PW ablegen dann flashen
        network: k9_dhcp
        radio: [11a_standard, 11g_standard]
        ifname_hint: k9

      - mode: mesh
        mesh_id: Mesh-Freifunk-Berlin
        radio: [11a_standard, 11g_standard, 11a_mesh]
        mcast_rate: 12000
        mesh_fwding: 0
        ifname_hint: mesh

ssh_keys:
  - comment: k9 iuljan
    key: ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINYwzmfKo1lXqBQFp7Ja26smNf0vMDZ8YTDWos3hO5jZ openwrt-k9@julian-m3
  - comment: k9 openwrt-vm
    key: ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJB+iuUg9LllHVecQ/PybZ4hGAfFwS4NbqU9gpt4TMV2 openwrt-vm